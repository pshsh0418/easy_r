---
title: "나이와 월급의 관계"
author: 박세화
date: July 30, 2020
output: github_document
---

```{r, include=F}
Sys.setenv("LANGUAGE"="EN")
library(foreign)             # SPSS 파일 로드
library(dplyr)               # 전처리
library(ggplot2)             # 시각화
library(readxl)              # 엑셀 파일 불러오기

# 데이터 불러오기
raw_welfare <- read.spss(file="Koweps_hpc10_2015_beta1.sav",
                         to.data.frame=T)

# 복사본 만들기
welfare <- raw_welfare

welfare <- rename(welfare,
                  sex=h10_g3,
                  birth=h10_g4,
                  marriage=h10_g10,
                  religion=h10_g11,
                  income=p1002_8aq1,
                  code_job=h10_eco9,
                  code_region=h10_reg7)
```

## 3. 나이와 월급의 관계
나이에 따라 월급이 어떻게 다른지 데이터 분석을 통해 알아본다.
먼저 나이 변수를 검토하고 전처리한다.

### 분석 절차
- 1단계 : 변수 검토 및 전처리 (나이, 월급)
- 2단계 : 변수 간 관계 분석 (나이에 따른 월급 평균표 만들기, 그래프 만들기)

#### 1. 변수 검토하기
한국복지패널데이터에 나이 변수가 없으므로 태어난 연도를 이용하여 나이 변수를 생성한다.
먼저 태어난 연도 변수를 검토한다.

```{r,eval=T,message=F}
class(welfare$birth)
summary(welfare$birth)
qplot(welfare$birth)
```

#### 2. 전처리
```{r,eval=F}
summary(welfare$birth)                                         # 이상치 확인
table(is.na(welfare$birth))                                    # 결측치 확인
welfare$birth <- ifelse(welfare$birth==9999,NA,welfare$birth)  # 이상치 결측 처리
table(is.na(welfare$birth))
```

#### 3. 파생변수 만들기 - 나이
2015년에 조사가 진행됐으므로 2015년에서 태어난 연도를 뺀 후 1을 더해 나이를 구한다.
```{r,eval=T,message=F}
welfare$age <- 2015 - welfare$birth +1
summary(welfare$age)
qplot(welfare$age)
```


### 나이와 월급의 관계 분석하기
전처리 작업이 끝났으니 나이에 따른 월급을 분석한다.

#### 1. 나이에 따른 월급 평균표 만들기
먼저 나이별 월급 평균표를 만든다.
```{r,eval=T}
age_income <- welfare %>% 
  filter(!is.na(income)) %>% 
  group_by(age) %>% 
  summarise(mean_income=mean(income))

head(age_income)
```

#### 2. 그래프 만들기
```{r,eval=T}
ggplot(data=age_income,aes(x=age,y=mean_income))+geom_line()
```

그래프를 통해 20대 초반에 100만원 가량의 월급을 받고, 이후 지속적으로 증가하는 추세를 보인다.
50대 무렵 300만원 초반대로 가장 많은 월급을 받고, 그 이후로 지속적으로 감소하다가 70대 이후에는 20대보다 낮은 월급을 받는다.