---
title: "성별 직업 빈도"
author: 박세화
date: July 31, 2020
output: github_document
---

```{r, include=F}
library(foreign)             # SPSS 파일 로드
library(dplyr)               # 전처리
library(ggplot2)             # 시각화
library(readxl)              # 엑셀 파일 불러오기

# 데이터 불러오기
raw_welfare <- read.spss(file = "Koweps_hpc10_2015_beta1.sav",
                         to.data.frame = T)

# 복사본 만들기
welfare <- raw_welfare

# 변수 이름 변경하기기
welfare <- rename(welfare,
                  sex = h10_g3,            # 성별
                  birth = h10_g4,          # 태어난 연도
                  marriage = h10_g10,      # 혼인 상태
                  religion = h10_g11,      # 종교
                  income = p1002_8aq1,     # 월급
                  code_job = h10_eco9,     # 직종 코드
                  code_region = h10_reg7)  # 지역 코드

# birth 이상치 결측 처리
welfare$birth <- ifelse(welfare$birth==9999,NA,welfare$birth)

# sex 이상치 결측 처리
welfare$income <- ifelse(welfare$income %in% c(0,9999),NA,welfare$income)

# age 파생변수 만들기
welfare$age <- 2015- welfare$birth +1

#ageg 파생변수 만들기
welfare <- welfare %>% 
  mutate(ageg=ifelse(age<30,"young",ifelse(age<60,"middle","old")))

# sex 값 이름 변경
welfare$sex <- ifelse(welfare$sex==1,"male","female")

# 직업 목록 변수 만들기
list_job <- read_excel("Koweps_Codebook.xlsx",col_names = T,sheet = 2)

# 직업 목록 welfare data frame에 합치기
welfare <- left_join(welfare,list_job,id="code_job")

```

## 7. 성별 직업 빈도
성별에 따라 어떤 직업에 많이 종사하고 있는지 분석한다.

### 분석 절차
- 1단계 : 변수 검토 및 전처리 (성별, 직업)
- 2단계 : 변수 간 상관 관계 분석 (성별 직업 빈도표 만들기, 그래프 만들기)

### 성별 직업 빈도 분석하기

#### 1. 성별 직업 빈도표 만들기
각 성별로 직업별 빈도를 구해 상위 10개를 추출한다.

```{r, results="markup"}

# 남성 직업 빈도 상위 10개 추출
job_male <- welfare %>% 
  filter(!is.na(job) & sex=="male") %>% 
  group_by(job) %>% 
  summarise(n=n()) %>% 
  arrange(desc(n)) %>% 
  head(10)

job_male

```

```{r,results="markup"}
# 여성 직업 빈도 상위 10개 추출
job_female <- welfare %>% 
  filter(!is.na(job) & sex=="female") %>% 
  group_by(job) %>% 
  summarise(n=n()) %>% 
  arrange(desc(n)) %>% 
  head(10)

job_female

```



#### 2. 그래프 만들기
성별 직업 빈도표를 이용하여 그래프를 만든다.
직업 명칭이 길기 때문에 직업 명칭을 모두 볼 수 있도록 90도 회전시킨 그래프를 만든다.

```{r, results="markup"}
# 남성 직업 빈도 상위 10개 직업
ggplot(data=job_male,aes(x=reorder(job,n),y=n))+
  geom_col()+
  coord_flip()
```
```{r,results="markup"}
# 여성 직업 빈도 상위 10개 직업
ggplot(data=job_female,aes(x=reorder(job,n),y=n))+
  geom_col()+
  coord_flip()
```

표와 그래프를 통해 남성과 여성 모두 '작물 재배 종사자'에 가장 많이 종사하고 있는 것을 확인할 수 있으며, 남성은 640명 여성은 680명이 종사하고 있다.
남성의 경우 '작물 재배 종사자' 다음으로 많이 종사하는 직업은 '자동차 운전원', '경영관련 사무원' 순이며 각각 251명, 213명이 종사하고 있다.
여성의 경우 '청소원 및 환경 미화원'이 두 번째로 많이 종사하고 있는 직업이며 228명이 종사하고 있고, '매장 판매 종사자'가 세 번째로 많이 종사하고 있는 직업이며 221명이 종사하고 있다.

