---
title: "성별에 따른 월급 차이"
author: 박세화
date: July 30, 2020
output: github_document
---

```{r, include=F}
Sys.setenv("LANGUAGE"="EN")
library(foreign)             # SPSS 파일 로드
library(dplyr)               # 전처리
library(ggplot2)             # 시각화
library(readxl)              # 엑셀 파일 불러오기

# 데이터 불러오기
raw_welfare <- read.spss(file="Koweps_hpc10_2015_beta1.sav",
                         to.data.frame=T)

# 복사본 만들기
welfare <- raw_welfare

welfare <- rename(welfare,
                  sex=h10_g3,
                  birth=h10_g4,
                  marriage=h10_g10,
                  religion=h10_g11,
                  income=p1002_8aq1,
                  code_job=h10_eco9,
                  code_region=h10_reg7)
```

## 2. 성별에 따른 월급 차이 
데이터 분석을 통해 성별에 따라 월급 차이가 있는지 알아본다.
먼저 성별과 월급 두 변수를 검토하고 전처리한 뒤 변수 간의 관계를 분석한다.

### 분석 절차
- 1단계 : 변수 검토 및 전처리 (성별, 월급)
- 2단계 : 변수 간 관계 분석 (성별 월급 평균표 만들기, 그래프 만들기)

### 성별 변수 검토 및 전처리 

#### 1. 변수 검토하기
```{r,eval=F}
class(welfare$sex)
table(welfare$sex)
```


#### 2. 전처리
데이터에 이상치가 있는지 검토하고, 분석에서 이상치를 제외할 수 있도록 NA를 부여한다.

```{r,eval=F}
table(welfare$sex)     # 이상치 확인
```

#### 이상치 결측 처리 및 확인
```{r,eval=T}
welfare$sex <- ifelse(welfare$sex==9,NA,welfare$sex)  # 이상치 결측 처리
table(is.na(welfare$sex))                             # 결측치 확인
```

값의 의미를 이해하기 쉽도록 문자 "male"과 "female"로 바꾸고 table(), qplot()을 이용해 바꾼 값이 반영됐는지 출력 결과를 확인한다.
```{r,eval=T}
welfare$sex <- ifelse(welfare$sex==1,"male","female")
table(welfare$sex)
qplot(welfare$sex)
```




### 월급 변수 검토 및 전처리

#### 1. 변수 검토하기
월급 변수를 검토하기 위해 summary()로 요약 통계량을 확인한다.

```{r,eval=F}
class(welfare$income)
summary(welfare$income)
```

qplot()으로 분포를 확인하고, 확인하기 쉽도록 범위를 조정해준다.
```{r,eval=T, warning=F, message=F}
qplot(welfare$income)+xlim(0,1000)
```

그래프를 통해 0~250만원 사이에 가장 많은 사람이 분포하고, 그 뒤로는 빈도가 점차 감소하는 것을 확인할 수 있다.


#### 2. 전처리
```{r,eval=T}
summary(welfare$income)     # 이상치 확인
```
코드북을 참고하여 값이 0이거나 9999인 경우 결측처리한다.
```{r,eval=F}
welfare$income <- ifelse(welfare$income %in% c(0,9999),NA,welfare$income)  # 이상치 결측 처리
table(is.na(welfare$income))                                               # 이상치 결측 확인
```

### 성별에 따른 월급 차이 분석하기

#### 1. 성별 월급 평균표 만들기
성별 월급 평균표를 만들어 비교해본다.

```{r,eval=T}
sex_income <- welfare %>% 
  filter(!is.na(income)) %>% 
  group_by(sex) %>% 
  summarise(mean_income=mean(income))
```

#### 2. 그래프 만들기
```{r,eval=T}
ggplot(data=sex_income,aes(x=sex,y=mean_income))+geom_col()
```

분석 결과를 통해 남성이 312만원, 여성이 163만원 정도의 월급을 수령하며 남성의 월급이 여성의 두 배 가까이 많다는 것을 알 수 있다.